% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covmodels.R
\name{cov_matern_deriv}
\alias{cov_matern_deriv}
\title{Matern covariance function for GP and its derivatives}
\usage{
cov_matern_deriv(locs, covparms, tol = .Machine$double.eps)
}
\arguments{
\item{locs}{A matrix of \code{n} locations}

\item{covparms}{A numerical vector with covariance parameters = c(sigma2, range, smoothness). Smoothness must be 2.5 or 4.5 for now.}

\item{tol}{A numerical tolerance at \code{.Machine$double.eps} by default}
}
\value{
A matrix with \code{n*d} rows and \code{n*d} columns
}
\description{
If d = 1, this function returns a Matern covariance matrix of (GP, dGP/dx) in 1-dimensional domain. If d = 2, this function returns a Matern covariance matrix of (GP, dGP/dx1, dGP/dx2) in 2-dimensional domain.
}
\examples{
locs <- matrix(runif(4), 4, 1)
covparms <- c(1, 0.1)
tol <- .Machine$double.eps

M <- cov_matern_deriv(locs, c(covparms, 2.5), tol)

t(M) == M # M is symmetric
eigen(M)$values # M is positive definite

M <- cov_matern_deriv(locs, c(covparms, 4.5), tol)

t(M) == M # M is symmetric
eigen(M)$values # M is positive definite

locs <- matrix(runif(8), 4, 2)
covparms <- c(1, 0.1)
tol <- .Machine$double.eps

M <- cov_matern_deriv(locs, c(covparms, 2.5), tol)

t(M) == M # M is symmetric
eigen(M)$values # M is positive definite

M <- cov_matern_deriv(locs, c(covparms, 4.5), tol)

t(M) == M # M is symmetric
eigen(M)$values # M is positive definite
}
